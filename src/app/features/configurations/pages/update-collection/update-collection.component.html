<div class="space-y-5">
    <div class="flex items-center space-x-2">
        <i class="pi pi-sync"></i>
        <h3 class="text-xl font-semibold ">Actualizar recaudación</h3>
    </div>

    <form [formGroup]="yearForm" class="space-y-5 w-1/3">
        <div class="flex gap-5 items-end w-full">
            <div>
                <label>Selecciona el año de apertura</label>
                <p-select
                    [options]="years"
                    optionLabel="year"
                    optionValue="year"
                    appendTo="body"
                    formControlName="year"
                    class="w-full"
                />
            </div>

            <div>
                <p-button
                    label="Ver"
                    icon="pi pi-check"
                    severity="contrast"
                    (click)="getOpeningList()"
                    [loading]="isLoading"
                    [disabled]="isLoading"
                />
            </div>
        </div>
    </form>

    <div class="p-5 border rounded-xl text-sm">
        @if (!isLoading) {
            <p-table #table [value]="openingList"
                     [paginator]="true"
                     [rows]="15"
                     [showCurrentPageReport]="true"
                     currentPageReportTemplate="Showing {first} to {last} from {totalRecords} records"
                     [rowsPerPageOptions]="[15, 30, 40]"
                     [globalFilterFields]="['anio', 'mes_letras', 'recaudacion', 'created_at']"
                     size="small"
            >
                <ng-template pTemplate="header">
                    <tr class="font-medium uppercase">
                        <th>Año</th>
                        <th>Mes</th>
                        <th>Recaudación</th>
                        <th>Fecha de creación</th>
                        <th>Actualizar</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-opening>
                    <tr>
                        <td>{{ opening.anio }}</td>
                        <td>{{ opening.mes_letras }}</td>
                        <td>{{ opening.recaudacion | currency }}</td>
                        <td>{{ opening.created_at | date }}</td>
                        <!--<td>
                            @for (status of companiesStatus; track status) {
                                @if (company.estatus === status.value) {
                                    <span class="{{ status.styles }} text-xs font-medium me-2 px-2.5 py-0.5 rounded">
                                        {{ status.name }}
                                    </span>
                                }
                            }
                        </td>-->
                        <td class="space-x-3">
                            <p-button
                                (click)="openUpdateCollectionDialog(opening)"
                                label="Actualizar"
                                icon="pi pi-refresh"
                            />
                        </td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="10">
                            <div class="flex flex-col text-center p-24 space-y-4">
                                <i class="pi pi-box text-gray-400" style="font-size: 2.5rem"></i>
                                <p class="font-medium text-lg text-gray-400">No se encontraron resultados</p>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        } @else {
            <app-table-skeleton></app-table-skeleton>
        }
    </div>
</div>
